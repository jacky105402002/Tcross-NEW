<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="utf-8" />
    <title>關卡三｜整併版（1~6頁）</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <!-- 套用你提供的 CSS -->
    <link rel="stylesheet" href="./styles/main.css" />

    <!-- 補丁：目前 main.css 缺的必要樣式（可之後移回 main.css），確保 4~6 背景與遊戲座標正常 -->
    <style>
      /* 1) 單頁多畫面顯示控制 */
      .screen {
        display: none;
      }
      .screen.is-active {
        display: block;
      }

      /* 2) 遊戲舞台/出現點：讓 .slot-* 的 left/top 生效 */
      .stage {
        position: absolute;
        inset: 0;
      }
      .spawn {
        position: absolute; /* ← 關鍵：非 static 才吃得到 left/top */
        width: var(--slot-size, 110px);
        transform: translate(-50%, -50%);
        display: none; /* 由 JS 控制顯示/隱藏 */
        z-index: 3;
        pointer-events: none;
      }
      .spawn > img {
        width: 100%;
        height: auto;
        display: block;
        pointer-events: auto;
        -webkit-user-drag: none;
        user-select: none;
        touch-action: manipulation;
      }
      @media (min-width: 1600px) {
        .spawn {
          --slot-size: 120px;
        }
      }
      @media (max-width: 1440px) {
        .spawn {
          --slot-size: 95px;
        }
      }
      @media (max-width: 1280px) {
        .spawn {
          --slot-size: 88px;
        }
      }

      /* 3) 第 4～6 頁背景圖（依你的新目錄結構） */
      .bg-end-01 {
        background: #fff url("./assets/images/1280x720/end-01.png") center/cover
          no-repeat;
      }
      .bg-end-02 {
        background: #fff url("./assets/images/1280x720/end-02.png") center/cover
          no-repeat;
      }
      .bg-end-03 {
        background: #fff url("./assets/images/1280x720/end-03.png") center/cover
          no-repeat;
      }

      /* 4) PlayBoard 下一步：預設隱藏，進到第 6 頁再顯示 */
      #nextButton[hidden] {
        display: none;
      }

      /* 讓放數字的容器成為定位參考點 */
      .result-wrap {
        position: relative; /* ← 關鍵：以它為基準定位三個數字 */
        inset: 0; /* 你若想讓它充滿 .game-wrap，可加上這行，或保留原本 absolute+inset:0 也行 */
        width: 100%;
        height: 100%;
      }

      /* 三個數字用絕對定位（只需要在 base 規則設一次即可） */
      #num-cut,
      #num-add,
      .total {
        position: absolute; /* ← 關鍵：非 static 才吃得到 left/top */
        transform: translate(-50%, -50%);
        z-index: 5;
      }
    </style>
  </head>

  <body>
    <!-- Page 1 -->
    <section id="screen-1" class="screen is-active" data-screen="l3-01-intro">
      <div class="game-wrap bg-prelude"></div>

      <div class="btn-row">
        <button class="img-btn" id="btn-confirm">
          <img src="./assets/images/check_off.png" alt="確認" />
        </button>
      </div>

      <div class="rotate-mask" id="rotateMask-01">
        <div class="rotate-box"><p>請將裝置旋轉為橫向以獲得最佳體驗</p></div>
      </div>
    </section>

    <!-- Page 2 -->
    <section id="screen-2" class="screen" data-screen="l3-02-hint">
      <div class="game-wrap bg-02"></div>

      <div class="btn-row">
        <button class="img-btn" id="btn-confirm-2">
          <img src="./assets/images/check_off.png" alt="確認" />
        </button>
        <button class="again-game">重新開始</button>
      </div>

      <div class="rotate-mask" id="rotateMask-02">
        <div class="rotate-box"><p>請將裝置旋轉為橫向以獲得最佳體驗</p></div>
      </div>
    </section>

    <!-- Page 3 -->
    <section id="screen-3" class="screen" data-screen="l3-03-game">
      <div class="game-wrap bg-game">
        <div class="stage" id="stage">
          <div class="timer-badge" id="timer">90</div>
          <button class="again-game">重新開始</button>
          <div class="score-pill">
            <span class="score-text" id="scorePill">0</span>
          </div>

          <div class="spawn slot-1" id="spawn-1"></div>
          <div class="spawn slot-2" id="spawn-2"></div>
          <div class="spawn slot-3" id="spawn-3"></div>
          <div class="spawn slot-4" id="spawn-4"></div>
          <div class="spawn slot-5" id="spawn-5"></div>
          <div class="spawn slot-6" id="spawn-6"></div>
        </div>
      </div>

      <div class="rotate-mask" id="rotateMask-03">
        <div class="rotate-box"><p>請將裝置旋轉為橫向以獲得最佳體驗</p></div>
      </div>
    </section>

    <!-- Page 4 -->
    <section id="screen-4" class="screen" data-screen="l3-04-result-1">
      <div class="game-wrap bg-end-01">
        <div class="result-wrap">
          <div class="cols">
            <div class="card"><div class="num" id="num-cut">0</div></div>
            <div class="card"><div class="num" id="num-add">0</div></div>
          </div>
          <div class="total"><span id="num-total">0</span></div>
        </div>
      </div>

      <div class="btn-row">
        <button class="img-btn" id="btn-confirm-4">
          <img src="./assets/images/check_off.png" alt="下一頁" />
        </button>
      </div>

      <div class="rotate-mask" id="rotateMask-04">
        <div class="rotate-box"><p>請將裝置旋轉為橫向以獲得最佳體驗</p></div>
      </div>
    </section>

    <!-- Page 5 -->
    <section id="screen-5" class="screen" data-screen="l3-05-result-2">
      <div class="game-wrap bg-end-02"></div>

      <div class="btn-row">
        <button class="img-btn" id="btn-confirm-5">
          <img src="./assets/images/check_off.png" alt="下一頁" />
        </button>
      </div>

      <div class="rotate-mask" id="rotateMask-05">
        <div class="rotate-box"><p>請將裝置旋轉為橫向以獲得最佳體驗</p></div>
      </div>
    </section>

    <!-- Page 6 -->
    <section id="screen-6" class="screen" data-screen="l3-06-result-3">
      <div class="game-wrap bg-end-03">
        <div class="btn-row">
          <button id="nextButton" class="img-btn" hidden>
            <img src="./assets/images/check_off.png" alt="下一步" />
          </button>
        </div>
      </div>

      <div class="rotate-mask" id="rotateMask-06">
        <div class="rotate-box"><p>請將裝置旋轉為橫向以獲得最佳體驗</p></div>
      </div>
    </section>

    <!-- PlayBoard 下一步：預設 hidden；第 6 頁才會顯示 -->
    <!-- <button id="nextButton" hidden>下一步</button> -->

    <!-- 進度控制（只處理 PlayBoard 通訊 & 下一步） -->
    <script src="assets/js/playboard.js"></script>
    <!-- 遊戲流程與計分（整合你原本兩段 script） -->
    <script src="assets/js/game.js"></script>
  </body>
</html>
